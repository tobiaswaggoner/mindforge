# Implementierungsplan: Admin UI (Frontend-Only)

**Erstellt**: 2025-11-26
**Referenz**: [docs/architecture/admin-ui.md](../architecture/admin-ui.md)
**Scope**: UI-Prototyp ohne Backend-Anbindung (gemockte Daten)

---

## Ausgangslage

### Bereits vorhanden

| Komponente | Status |
|------------|--------|
| Next.js 16 (App Router) | ✅ Konfiguriert |
| Tailwind CSS v4 | ✅ Konfiguriert mit Dark/Light Theme |
| shadcn/ui | ✅ 4 Komponenten (Button, Card, Input, Table) |
| Home Page | ✅ Einfaches Dashboard-Scaffolding |
| TypeScript | ✅ Strict Mode |
| Docker | ✅ Production-ready |

### Noch zu implementieren

- Layout-System (TopNav, Sidebar, Page-Container)
- Dark/Light Mode Toggle
- Authentication Pages (gemockt)
- Content Editor
- Task Management
- Generate Modal
- Responsive Design
- Mockdaten-System

---

## Phasen-Übersicht

```
Phase 1: Layout & Theme        [~2h]  → Grundgerüst steht
Phase 2: Mock-Auth & Routing   [~1h]  → Navigation funktioniert
Phase 3: Dashboard             [~1h]  → Übersichtsseite
Phase 4: Content Editor        [~3h]  → Kernfunktion Editor
Phase 5: Task Management       [~2h]  → Task-Liste & Details
Phase 6: Generate Modal        [~1h]  → Content-Generierung UI
Phase 7: Responsive & Polish   [~2h]  → Mobile-Optimierung
```

---

## Phase 1: Layout & Theme

### Ziel
Grundlegendes Layout-System mit TopNav, optionaler Sidebar und funktionierendem Dark/Light Mode Toggle.

### Aufgaben

1. **Layout-Komponenten erstellen**
   - `src/components/layout/top-nav.tsx` - Haupt-Navigation
   - `src/components/layout/sidebar.tsx` - Kontextuelle Sidebar
   - `src/components/layout/page-container.tsx` - Content-Wrapper
   - `src/components/layout/breadcrumb.tsx` - Breadcrumb-Navigation

2. **Theme-System**
   - Dark/Light Mode Toggle in TopNav
   - Theme-Persistenz via localStorage
   - System-Präferenz als Default (`prefers-color-scheme`)

3. **Farbschema anpassen**
   - Primary Color auf Deep Orange (#ff6d00) setzen
   - Anthrazit-Töne für Backgrounds verifizieren

4. **shadcn/ui Komponenten hinzufügen**
   ```bash
   npx shadcn@latest add dropdown-menu
   npx shadcn@latest add avatar
   npx shadcn@latest add separator
   npx shadcn@latest add tooltip
   ```

### Prüfbares Ergebnis
- [ ] TopNav mit Logo, Navigation-Links, Theme-Toggle, User-Avatar
- [ ] Dark/Light Mode funktioniert und wird persistiert
- [ ] Farbschema entspricht MindForge Brand (Orange/Anthrazit)
- [ ] Layout passt sich an Viewport an

### Dateien
```
src/
├── components/
│   └── layout/
│       ├── top-nav.tsx
│       ├── sidebar.tsx
│       ├── page-container.tsx
│       └── breadcrumb.tsx
├── hooks/
│   └── use-theme.ts
└── app/
    └── layout.tsx (anpassen)
```

---

## Phase 2: Mock-Auth & Routing

### Ziel
Authentifizierungs-Pages (UI only) und geschützte Routen mit Mock-Provider.

### Aufgaben

1. **Auth-Pages erstellen**
   - `/login` - Login-Formular
   - `/register` - Registrierungs-Formular
   - `/forgot-password` - Passwort-Reset anfordern
   - `/reset-password` - Neues Passwort setzen

2. **Mock-Auth-Context**
   - `src/contexts/auth-context.tsx`
   - Simuliert Login/Logout
   - Speichert "Session" in localStorage
   - Bypass via `NEXT_PUBLIC_AUTH_MOCK=true`

3. **Route Protection**
   - Auth-Layout für geschützte Routen
   - Redirect zu `/login` wenn nicht authentifiziert
   - Redirect zu `/dashboard` nach Login

4. **shadcn/ui Komponenten hinzufügen**
   ```bash
   npx shadcn@latest add form
   npx shadcn@latest add label
   npx shadcn@latest add checkbox
   ```

### Prüfbares Ergebnis
- [ ] Login-Page mit Email/Password-Feldern
- [ ] Register-Page mit Validierung
- [ ] Forgot/Reset Password Pages
- [ ] Mock-Login funktioniert (beliebige Credentials)
- [ ] Nach Login: Redirect zu Dashboard
- [ ] Logout funktioniert

### Dateien
```
src/
├── app/
│   ├── (auth)/
│   │   ├── login/page.tsx
│   │   ├── register/page.tsx
│   │   ├── forgot-password/page.tsx
│   │   └── reset-password/page.tsx
│   └── (protected)/
│       └── layout.tsx
├── contexts/
│   └── auth-context.tsx
└── lib/
    └── mock-auth.ts
```

---

## Phase 3: Dashboard

### Ziel
Vollständiges Dashboard mit Live-Task-Anzeige, Statistiken und Quick Actions.

### Aufgaben

1. **Dashboard-Layout**
   - Zwei-Spalten-Layout (Desktop)
   - Vertikales Stack (Mobile)

2. **Komponenten**
   - `ActiveTasksCard` - Laufende Tasks mit Progress
   - `RecentChangesCard` - Timeline der letzten Änderungen
   - `QuickStatsCard` - Subjects, Clusters, Variants, Answers
   - `QuickActionsCard` - Buttons für häufige Aktionen

3. **Mockdaten**
   - `src/lib/mock-data/dashboard.ts`
   - Statische Demo-Daten

4. **shadcn/ui Komponenten hinzufügen**
   ```bash
   npx shadcn@latest add progress
   npx shadcn@latest add badge
   npx shadcn@latest add scroll-area
   ```

### Prüfbares Ergebnis
- [ ] Dashboard zeigt 4 Karten-Bereiche
- [ ] Active Tasks mit Fortschrittsbalken
- [ ] Recent Changes als Timeline
- [ ] Quick Stats mit Zahlen
- [ ] Quick Actions klickbar (öffnen später Modals/Navigation)

### Dateien
```
src/
├── app/
│   └── (protected)/
│       └── dashboard/
│           └── page.tsx
├── components/
│   └── dashboard/
│       ├── active-tasks-card.tsx
│       ├── recent-changes-card.tsx
│       ├── quick-stats-card.tsx
│       └── quick-actions-card.tsx
└── lib/
    └── mock-data/
        └── dashboard.ts
```

---

## Phase 4: Content Editor

### Ziel
Master-Detail-Editor für Subject → Cluster → Variant → Answer Hierarchie.

### Aufgaben

1. **Mockdaten erstellen**
   - `src/lib/mock-data/content.ts`
   - 2-3 Subjects mit realistischen deutschen Mathe-Fragen
   - Cluster mit je 3-5 Variants
   - Variants mit je 4 Answers

2. **Content-State-Management**
   - `src/contexts/content-context.tsx`
   - CRUD-Operationen auf Mockdaten
   - Filter-State (Subject, Task, Search)

3. **Komponenten**
   - `ContentSidebar` - Subject/Cluster-Baum
   - `ContentDetail` - Detail-Ansicht je nach Auswahl
   - `SubjectDetail` - Subject-Info + Cluster-Liste
   - `ClusterDetail` - Cluster-Info + Variant-Liste
   - `VariantDetail` - Variant-Info + Answer-Liste
   - `AnswerEditor` - Inline-Editing für Answers
   - `ContentFilter` - Such- und Filter-Bar

4. **Inline-Editing**
   - Doppelklick zum Editieren
   - Enter zum Speichern, Escape zum Abbrechen

5. **shadcn/ui Komponenten hinzufügen**
   ```bash
   npx shadcn@latest add dialog
   npx shadcn@latest add textarea
   npx shadcn@latest add select
   npx shadcn@latest add accordion
   npx shadcn@latest add alert-dialog
   npx shadcn@latest add switch
   ```

### Prüfbares Ergebnis
- [ ] Sidebar zeigt Subject-Hierarchie
- [ ] Klick auf Subject zeigt Cluster-Liste
- [ ] Klick auf Cluster zeigt Variants
- [ ] Klick auf Variant zeigt Answers
- [ ] Breadcrumb zeigt aktuelle Position
- [ ] Inline-Editing funktioniert
- [ ] Filter-Suche funktioniert
- [ ] "Generate"-Buttons sind sichtbar (öffnen Modal in Phase 6)

### Dateien
```
src/
├── app/
│   └── (protected)/
│       └── content/
│           ├── page.tsx
│           └── [id]/
│               └── page.tsx
├── components/
│   └── content/
│       ├── content-sidebar.tsx
│       ├── content-detail.tsx
│       ├── subject-detail.tsx
│       ├── cluster-detail.tsx
│       ├── variant-detail.tsx
│       ├── answer-editor.tsx
│       └── content-filter.tsx
├── contexts/
│   └── content-context.tsx
└── lib/
    └── mock-data/
        └── content.ts
```

---

## Phase 5: Task Management

### Ziel
Task-Liste mit Status-Tabs, Progress-Anzeige und Actions (Accept, Revert, Cancel).

### Aufgaben

1. **Mockdaten erstellen**
   - `src/lib/mock-data/tasks.ts`
   - Tasks in verschiedenen Status (pending, in_progress, completed, failed)
   - Progress-Daten, Error-Messages, Retry-Counts

2. **Task-State-Management**
   - `src/contexts/task-context.tsx`
   - Task-Liste mit Filter
   - Simulierte Progress-Updates (Timer)

3. **Komponenten**
   - `TaskList` - Liste mit Status-Tabs
   - `TaskCard` - Einzelner Task mit Progress
   - `TaskStatusBadge` - Farbige Status-Anzeige
   - `TaskActions` - Buttons (View, Accept, Revert, Cancel, Retry)

4. **Task-Detail-View**
   - `/tasks/[id]` - Vollständige Task-Details
   - Content-Log Anzeige (was wurde generiert?)

5. **Simulierte Progress-Updates**
   - Laufende Tasks zeigen animierten Fortschritt
   - Progress-Message ändert sich

6. **Toast Notifications**
   ```bash
   npx shadcn@latest add toast
   npx shadcn@latest add sonner
   ```

### Prüfbares Ergebnis
- [ ] Task-Liste mit Status-Filter-Tabs
- [ ] Laufende Tasks zeigen animierten Progress
- [ ] Failed Tasks zeigen Error + Retry-Counter
- [ ] "Accept" setzt accepted_at, zeigt Toast
- [ ] "Revert" zeigt Bestätigungs-Dialog, dann Toast mit Zusammenfassung
- [ ] "Cancel" bricht Task ab
- [ ] Klick auf Task öffnet Detail-View
- [ ] "View Results" navigiert zu Content Editor mit Task-Filter

### Dateien
```
src/
├── app/
│   └── (protected)/
│       └── tasks/
│           ├── page.tsx
│           └── [id]/
│               └── page.tsx
├── components/
│   └── tasks/
│       ├── task-list.tsx
│       ├── task-card.tsx
│       ├── task-status-badge.tsx
│       ├── task-actions.tsx
│       └── task-detail.tsx
├── contexts/
│   └── task-context.tsx
└── lib/
    └── mock-data/
        └── tasks.ts
```

---

## Phase 6: Generate Modal

### Ziel
Einheitlicher Dialog zum Starten von Generierungs-Tasks.

### Aufgaben

1. **Modal-Komponente**
   - `GenerateModal` - Wiederverwendbar für alle Task-Typen
   - Context-Anzeige (welches Subject/Cluster/Variant?)
   - Task-Typ-Auswahl (Questions, Variants, Answers)
   - Parameter-Eingabe (Count, etc.)
   - Textarea für user_context

2. **Integration in Content Editor**
   - "Generate Questions" bei Subject
   - "Generate Variants" bei Cluster
   - "Regenerate Answers" bei Variant

3. **Task-Erstellung**
   - Modal erstellt Mock-Task
   - Task erscheint in Task-Liste
   - Simulierter Progress startet

4. **shadcn/ui Komponenten hinzufügen**
   ```bash
   npx shadcn@latest add slider
   npx shadcn@latest add radio-group
   ```

### Prüfbares Ergebnis
- [ ] Generate-Buttons im Content Editor öffnen Modal
- [ ] Modal zeigt korrekten Context
- [ ] Parameter sind einstellbar
- [ ] Additional Instructions Textarea funktioniert
- [ ] "Start Generation" erstellt Task und schließt Modal
- [ ] Neuer Task erscheint in Task-Liste
- [ ] Toast bestätigt Task-Erstellung

### Dateien
```
src/
├── components/
│   └── generate/
│       ├── generate-modal.tsx
│       ├── generate-form.tsx
│       └── task-type-selector.tsx
└── hooks/
    └── use-generate-modal.ts
```

---

## Phase 7: Responsive & Polish

### Ziel
Mobile-Optimierung, Animationen, Error States, Loading States.

### Aufgaben

1. **Mobile Navigation**
   - Bottom-Tab-Bar für Mobile
   - Hamburger-Menü oder Sheet für Sidebar
   - Touch-optimierte Targets (44x44px)

2. **Mobile Content Editor**
   - Full-Screen Detail-View
   - Back-Button Navigation
   - Swipe-Gesten (optional)

3. **Loading States**
   - Skeleton-Loader für Listen
   - Spinner für Actions

4. **Error States**
   - Circuit Breaker Banner ("Service temporarily unavailable")
   - Empty States für leere Listen
   - Error Boundaries

5. **Animationen**
   - Page Transitions (optional)
   - Card Hover Effects
   - Progress-Bar Animation

6. **Keyboard Navigation**
   - Focus Management
   - Escape schließt Modals
   - Tab-Navigation

7. **shadcn/ui Komponenten hinzufügen**
   ```bash
   npx shadcn@latest add skeleton
   npx shadcn@latest add sheet
   npx shadcn@latest add tabs
   npx shadcn@latest add alert
   ```

### Prüfbares Ergebnis
- [ ] App funktioniert auf Mobile (< 768px)
- [ ] Navigation ist touch-freundlich
- [ ] Loading-Zustände sind sichtbar
- [ ] Leere Listen zeigen hilfreiche Empty States
- [ ] Animationen sind subtil aber spürbar
- [ ] Tastatur-Navigation funktioniert

### Dateien
```
src/
├── components/
│   ├── layout/
│   │   ├── mobile-nav.tsx
│   │   └── mobile-sheet.tsx
│   └── ui/
│       ├── loading-skeleton.tsx
│       ├── empty-state.tsx
│       └── error-banner.tsx
└── app/
    └── error.tsx
    └── loading.tsx
```

---

## Mockdaten-Struktur

### Übersicht

```typescript
// src/lib/mock-data/index.ts
export * from './subjects';
export * from './clusters';
export * from './variants';
export * from './answers';
export * from './tasks';
export * from './dashboard';
```

### Beispiel-Daten (Mathematik 9)

```typescript
// src/lib/mock-data/content.ts
export const mockSubjects: Subject[] = [
  {
    id: 'subj-math-9',
    key: 'mathe-9',
    name: 'Mathematik 9. Klasse',
  },
  {
    id: 'subj-math-9-algebra',
    key: 'mathe-9-algebra',
    name: 'Mathematik 9 - Algebra',
  },
];

export const mockClusters: QuestionCluster[] = [
  {
    id: 'clust-lin-eq',
    subject_id: 'subj-math-9-algebra',
    topic: 'Lineare Gleichungen lösen',
    canonical_template: 'Löse die Gleichung nach x auf',
    difficulty_baseline: 4,
  },
  {
    id: 'clust-quad-eq',
    subject_id: 'subj-math-9-algebra',
    topic: 'Quadratische Gleichungen',
    canonical_template: 'Bestimme die Lösungen der quadratischen Gleichung',
    difficulty_baseline: 6,
  },
];

export const mockVariants: QuestionVariant[] = [
  {
    id: 'var-lin-001',
    cluster_id: 'clust-lin-eq',
    question_text: 'Löse die Gleichung: 2x + 3 = 7',
  },
  {
    id: 'var-lin-002',
    cluster_id: 'clust-lin-eq',
    question_text: 'Löse die Gleichung: 4x - 1 = 11',
  },
  {
    id: 'var-lin-003',
    cluster_id: 'clust-lin-eq',
    question_text: 'Löse die Gleichung: 3(x + 2) = 15',
  },
];

export const mockAnswers: Answer[] = [
  // Variant var-lin-001
  { id: 'ans-001-a', variant_id: 'var-lin-001', answer_text: 'x = 2', is_correct: true },
  { id: 'ans-001-b', variant_id: 'var-lin-001', answer_text: 'x = 5', is_correct: false },
  { id: 'ans-001-c', variant_id: 'var-lin-001', answer_text: 'x = -2', is_correct: false },
  { id: 'ans-001-d', variant_id: 'var-lin-001', answer_text: 'x = 4', is_correct: false },
  // ... weitere Answers
];
```

---

## TypeScript Types

```typescript
// src/types/content.ts
export interface Subject {
  id: string;
  key: string;
  name: string;
}

export interface QuestionCluster {
  id: string;
  subject_id: string;
  topic: string;
  canonical_template: string | null;
  difficulty_baseline: number;
}

export interface QuestionVariant {
  id: string;
  cluster_id: string;
  question_text: string;
}

export interface Answer {
  id: string;
  variant_id: string;
  answer_text: string;
  is_correct: boolean;
}

// src/types/tasks.ts
export type TaskStatus = 'pending' | 'in_progress' | 'completed' | 'failed' | 'cancelled';
export type TaskType = 'generate_clusters' | 'generate_variants' | 'regenerate_answers';

export interface GenerationTask {
  id: string;
  task_type: TaskType;
  status: TaskStatus;
  payload: Record<string, unknown>;
  user_context: string | null;
  created_at: string;
  started_at: string | null;
  completed_at: string | null;
  delayed_until: string | null;
  progress_current: number;
  progress_total: number;
  progress_message: string | null;
  error_message: string | null;
  retry_count: number;
  max_retries: number;
  accepted_at: string | null;
  reverted_at: string | null;
}

export interface TaskContentLog {
  id: string;
  task_id: string;
  entity_type: 'cluster' | 'variant' | 'answer';
  entity_id: string;
  action: 'created' | 'updated' | 'deleted';
  previous_data: string | null;
  created_at: string;
}
```

---

## Abhängigkeiten zwischen Phasen

```
Phase 1 (Layout)
    │
    ▼
Phase 2 (Auth) ──────────────────────────────┐
    │                                         │
    ▼                                         │
Phase 3 (Dashboard) ◄─────────────────────────┤
    │                                         │
    ├──────────────────┐                      │
    ▼                  ▼                      │
Phase 4 (Content) ◄── Phase 5 (Tasks) ◄──────┘
    │                  │
    └───────┬──────────┘
            ▼
    Phase 6 (Generate Modal)
            │
            ▼
    Phase 7 (Responsive)
```

---

## Abnahmekriterien (Gesamtprojekt)

Nach Abschluss aller Phasen:

- [ ] **Auth Flow**: Login → Dashboard → Logout funktioniert
- [ ] **Content Editor**: Vollständige Hierarchie navigierbar und editierbar
- [ ] **Task Management**: Tasks können gestartet, überwacht, akzeptiert/reverted werden
- [ ] **Generate Modal**: Alle drei Task-Typen können gestartet werden
- [ ] **Responsive**: App funktioniert auf Desktop und Mobile
- [ ] **Theme**: Dark/Light Mode funktioniert
- [ ] **Mockdaten**: Realistische deutsche Mathematik-Inhalte
- [ ] **Keine Console Errors**: Saubere Implementierung
- [ ] **TypeScript**: Keine Type-Errors

---

## Hinweise zur Implementierung

1. **Mockdaten zuerst**: Vor jeder Phase die benötigten Mockdaten definieren
2. **Komponenten isoliert**: Jede Komponente sollte einzeln testbar sein
3. **State minimal**: Nur so viel State wie nötig, Context nur wo sinnvoll
4. **shadcn/ui bevorzugen**: Existierende Komponenten nutzen statt selbst bauen
5. **Deutsche UI-Texte**: Gemäß CLAUDE.md sind UI-Texte auf Deutsch
6. **Commits pro Phase**: Nach jeder Phase einen sauberen Commit
